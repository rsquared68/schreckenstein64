# Schreckenstein-64

This project is a study of Peter Finzel’s superb two-player head-to-head jump and run dungeon explorer for the Atari line of 8-bit home computers and my attempt to accurately port it to the Commodore 64. I discovered this game when a friend gifted me an 800XL and I had a blast playing it. I had been thinking of trying a C64 project to build on what little 6510 coding skills I had remaining since the 1980s, and the complexity of the display of the original game seemed like it would be really challenging for me to implement.  However, with all that had been learned by democoders since I last touched a C64 it seemed like it was maybe possible.

Now just about a year later I have something that works. It is a little slower than the original because of the CPU clock difference, the lack of CPU-independent display list processing in the C64, and the fact that screen memory occurs in fixed blocks within the VIC bank and you can’t just point to an arbitrary memory location as the start of a screen like you can with the Atari.  Therefore the CPU is doing a lot of heavy lifting with raster interrupts not required on the Atari.  This is my first project of this type other than a few small and mostly unimpressive demoparts, so there were quite a few weeks where I thought it might actually be impossible.  But with the magic of memcopy speedcode generated realtime each frame to permit absolute loads and a few other tricks, I managed to be able to draw all of the graphical elements.  After convincing myself of the proof of concept, I started to disassemble and reverse-engineer the Homesoft “[a2]” crack of the original game to uncover and extract the game engine for integration with my graphical kernel.  That worked, so I somewhat hastily added a sound engine and option/hi-score/victory screen code to arrive at the RC1 package here.  Really the only thing I’m unsatisfied with at this point is the sound-effect gating and arbitration.  In addition to its graphics, Peter’s original Atari game is remarkable for the variety and detail of the 32 different sound effects, which usually use 3 but sometimes 4 POKEY audio channels.  The SID only has three channels, has complicated re-gating “requirements” (due to the envelope bug), and I need to sparingly use channel 3 because it is also my random number generator.  As a result the sounds don’t always trigger properly and some effects need to be pre-empted by others of higher priority.

Special thanks are due to Peter Finzel himself, who graciously permitted me open release of his disassembled and reverse-engineered binary in this repository.  He’s still coding after so many years and it was great to have a short exchange of messages with him.  He mentioned that part of the original was written the Atari language Action! and you may detect a certain kind of repeating code template in the source if you examine it.  He also mention that he used his own Action! runtime library for some of the implementation; so this code represents quite a view into Atari development history for that time period.


## Architectural discussion

TODO
